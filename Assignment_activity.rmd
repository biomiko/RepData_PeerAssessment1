#Personal movement analysis

```{r, include=FALSE}
setwd("D:/LAB/Conference/Coursea/DATA_SCIENCE/5_Reproducible_research/Week2")

```

##Load packages.
```{r, results='hide', message=FALSE, warning=FALSE}
library(dplyr)
library(lattice)
library(mice)

```

##1. Code for reading in the dataset and/or processing the data
```{r}
activity <- read.csv(unzip("repdata_data_activity.zip"))
activity_day <- activity %>%
      group_by(date) %>%
      summarise(steps = sum(steps, na.rm=TRUE))
```

##2. Histogram of the total number of steps taken each day
```{r}
hist(activity_day$steps)
```

##3. Mean and median number of steps taken each day
```{r}
mean_meadian <- activity %>%
    group_by(date) %>%
    summarise(mean = mean(steps, na.rm=TRUE), median=median(steps, na.rm=TRUE))
mean_meadian
```

##4. Time series plot of the average number of steps taken
```{r}
activity_interval <- activity %>%
      group_by(interval) %>%
      summarise(mean_steps = mean(steps, na.rm=TRUE))

with(activity_interval, plot(interval, mean_steps, type="l"))
```

##5. The 5-minute interval that, on average, contains the maximum number of steps
```{r}
activity[which(activity$steps == max(activity$steps, na.rm=TRUE)),]
```

##6. Code to describe and show a strategy for imputing missing data
```{r}
sum(is.na(activity$steps))
imputed_Data <- mice(activity, m=2, maxit = 2, method = 'pmm', seed = 500)
activity_complete <- complete(imputed_Data,2)
```

##7. Histogram of the total number of steps taken each day after missing values are imputed
```{r}
activity_day_complete <- activity_complete %>%
      group_by(date) %>%
      summarise(steps = sum(steps))

hist(activity_day_complete$steps)

```

##8. Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends
```{r}
activity_complete$weekdays <- weekdays(as.Date(activity_complete$date,'%Y-%m-%d'))
activity_complete$day <- "weekday"
activity_complete$day[activity_complete$weekdays %in% c("Saturday", "Sunday")] <- "weekend"

activity_interval_complete <- activity_complete %>%
      group_by(interval, day) %>%
      summarise(steps = mean(steps))
xyplot (steps~interval | day, data=activity_interval_complete, type="l")
```
